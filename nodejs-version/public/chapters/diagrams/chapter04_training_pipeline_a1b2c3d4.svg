<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #2d3748; }
      .label { font: 16px sans-serif; fill: #2d3748; }
      .small-label { font: 14px sans-serif; fill: #4a5568; }
      .annotation { font: 13px sans-serif; fill: #718096; }
      .timing { font: bold 14px sans-serif; fill: #e53e3e; }
      .box { fill: #667eea; stroke: #4c51bf; stroke-width: 2; }
      .box-data { fill: #48bb78; stroke: #38a169; stroke-width: 2; }
      .box-compute { fill: #667eea; stroke: #4c51bf; stroke-width: 2; }
      .box-comm { fill: #f093fb; stroke: #e879f9; stroke-width: 2; }
      .box-checkpoint { fill: #ed8936; stroke: #dd6b20; stroke-width: 2; }
      .arrow { stroke: #4a5568; stroke-width: 3; fill: none; marker-end: url(#arrowhead); }
      .arrow-loop { stroke: #718096; stroke-width: 2; fill: none; marker-end: url(#arrowhead); stroke-dasharray: 5,5; }
      .bottleneck { fill: #fed7d7; stroke: #fc8181; stroke-width: 2; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4a5568" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" class="title" text-anchor="middle">Training Pipeline Architecture</text>
  
  <!-- Stage 1: Data Loading -->
  <rect x="50" y="100" width="200" height="80" class="box-data" rx="5"/>
  <text x="150" y="130" class="label" text-anchor="middle">Data Loading</text>
  <text x="150" y="150" class="small-label" text-anchor="middle">&amp; Preprocessing</text>
  <text x="150" y="170" class="timing" text-anchor="middle">~50ms</text>
  
  <!-- Bottleneck indicator -->
  <rect x="40" y="190" width="220" height="25" class="bottleneck" rx="3"/>
  <text x="150" y="207" class="annotation" text-anchor="middle">Potential Bottleneck</text>
  
  <!-- Arrow to Forward Pass -->
  <path d="M 250 140 L 340 140" class="arrow"/>
  
  <!-- Stage 2: Forward Pass -->
  <rect x="340" y="100" width="200" height="80" class="box-compute" rx="5"/>
  <text x="440" y="130" class="label" text-anchor="middle">Forward Pass</text>
  <text x="440" y="150" class="small-label" text-anchor="middle">Compute Predictions</text>
  <text x="440" y="170" class="timing" text-anchor="middle">~300ms</text>
  
  <!-- Arrow to Backward Pass -->
  <path d="M 540 140 L 630 140" class="arrow"/>
  
  <!-- Stage 3: Backward Pass -->
  <rect x="630" y="100" width="200" height="80" class="box-compute" rx="5"/>
  <text x="730" y="130" class="label" text-anchor="middle">Backward Pass</text>
  <text x="730" y="150" class="small-label" text-anchor="middle">Compute Gradients</text>
  <text x="730" y="170" class="timing" text-anchor="middle">~300ms</text>
  
  <!-- Arrow to Gradient Aggregation -->
  <path d="M 730 180 L 730 280" class="arrow"/>
  
  <!-- Stage 4: Gradient Aggregation -->
  <rect x="630" y="280" width="200" height="80" class="box-comm" rx="5"/>
  <text x="730" y="310" class="label" text-anchor="middle">Gradient</text>
  <text x="730" y="330" class="label" text-anchor="middle">Aggregation</text>
  <text x="730" y="350" class="timing" text-anchor="middle">~100ms</text>
  
  <!-- Bottleneck indicator -->
  <rect x="620" y="370" width="220" height="25" class="bottleneck" rx="3"/>
  <text x="730" y="387" class="annotation" text-anchor="middle">Communication Bottleneck</text>
  
  <!-- Arrow to Parameter Update -->
  <path d="M 630 320 L 540 320" class="arrow"/>
  
  <!-- Stage 5: Parameter Update -->
  <rect x="340" y="280" width="200" height="80" class="box-compute" rx="5"/>
  <text x="440" y="310" class="label" text-anchor="middle">Parameter</text>
  <text x="440" y="330" class="label" text-anchor="middle">Update</text>
  <text x="440" y="350" class="timing" text-anchor="middle">~50ms</text>
  
  <!-- Arrow to Checkpoint decision -->
  <path d="M 340 320 L 250 320" class="arrow"/>
  
  <!-- Stage 6: Checkpoint Decision -->
  <path d="M 150 280 L 200 320 L 150 360 L 100 320 Z" fill="#ed8936" stroke="#dd6b20" stroke-width="2"/>
  <text x="150" y="315" class="small-label" text-anchor="middle">Every</text>
  <text x="150" y="335" class="small-label" text-anchor="middle">N steps?</text>
  
  <!-- Arrow to Checkpointing -->
  <path d="M 150 360 L 150 450" class="arrow"/>
  <text x="170" y="410" class="annotation">Yes</text>
  
  <!-- Stage 7: Checkpointing -->
  <rect x="50" y="450" width="200" height="80" class="box-checkpoint" rx="5"/>
  <text x="150" y="480" class="label" text-anchor="middle">Checkpointing</text>
  <text x="150" y="500" class="small-label" text-anchor="middle">Save Training State</text>
  <text x="150" y="520" class="timing" text-anchor="middle">~2-5s</text>
  
  <!-- Loop back arrow -->
  <path d="M 100 280 L 100 240 L 150 240 L 150 180" class="arrow-loop"/>
  <text x="60" y="260" class="annotation">No</text>
  
  <path d="M 150 530 L 150 600 L 900 600 L 900 140 L 830 140" class="arrow-loop"/>
  <text x="500" y="620" class="annotation" text-anchor="middle">Continue Training Loop</text>
  
  <!-- Summary box -->
  <rect x="50" y="660" width="1100" height="120" fill="#f7fafc" stroke="#cbd5e0" stroke-width="2" rx="5"/>
  <text x="600" y="690" class="label" text-anchor="middle">Total Time per Step: ~800ms (without checkpoint) or ~3-5s (with checkpoint)</text>
  
  <text x="100" y="720" class="annotation">Key Bottlenecks:</text>
  <text x="100" y="740" class="annotation">1. Data Loading: Can limit GPU utilization if not optimized</text>
  <text x="100" y="760" class="annotation">2. Gradient Aggregation: Communication overhead scales with GPU count</text>
</svg>
