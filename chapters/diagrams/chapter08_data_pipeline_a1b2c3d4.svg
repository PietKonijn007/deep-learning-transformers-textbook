<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 600">
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#667eea" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="700" y="40" font-size="24" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">
    Data Preprocessing Pipeline Architecture
  </text>
  
  <!-- Stage 1: Raw Data Ingestion -->
  <rect x="50" y="100" width="180" height="120" rx="8" fill="#dbeafe" stroke="#667eea" stroke-width="2"/>
  <text x="140" y="140" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Raw Data</text>
  <text x="140" y="165" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Ingestion</text>
  <text x="140" y="190" font-size="13" text-anchor="middle" fill="#4b5563" font-family="Arial, sans-serif">10-100 GB/hr</text>
  <text x="140" y="210" font-size="12" text-anchor="middle" fill="#6b7280" font-style="italic" font-family="Arial, sans-serif">I/O-bound</text>
  
  <!-- Arrow 1 -->
  <line x1="230" y1="160" x2="280" y2="160" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 2: Cleaning & Filtering -->
  <rect x="280" y="100" width="180" height="120" rx="8" fill="#fed7aa" stroke="#f59e0b" stroke-width="3"/>
  <text x="370" y="135" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Cleaning</text>
  <text x="370" y="160" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Filtering</text>
  <text x="370" y="185" font-size="13" text-anchor="middle" fill="#4b5563" font-family="Arial, sans-serif">1-10 GB/hr</text>
  <text x="370" y="205" font-size="12" text-anchor="middle" fill="#dc2626" font-weight="bold" font-family="Arial, sans-serif">CPU-bound</text>
  
  <!-- Arrow 2 -->
  <line x1="460" y1="160" x2="510" y2="160" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 3: Tokenization -->
  <rect x="510" y="100" width="180" height="120" rx="8" fill="#fde68a" stroke="#f59e0b" stroke-width="2"/>
  <text x="600" y="140" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Tokenization</text>
  <text x="600" y="170" font-size="13" text-anchor="middle" fill="#4b5563" font-family="Arial, sans-serif">5-10 GB/hr</text>
  <text x="600" y="190" font-size="12" text-anchor="middle" fill="#f59e0b" font-weight="bold" font-family="Arial, sans-serif">CPU-bound</text>
  <text x="600" y="210" font-size="11" text-anchor="middle" fill="#6b7280" font-family="Arial, sans-serif">SentencePiece</text>
  
  <!-- Arrow 3 -->
  <line x1="690" y1="160" x2="740" y2="160" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 4: Sequence Construction -->
  <rect x="740" y="100" width="180" height="120" rx="8" fill="#d1fae5" stroke="#10b981" stroke-width="2"/>
  <text x="830" y="135" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Sequence</text>
  <text x="830" y="160" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Construction</text>
  <text x="830" y="185" font-size="13" text-anchor="middle" fill="#4b5563" font-family="Arial, sans-serif">10-100 GB/hr</text>
  <text x="830" y="205" font-size="12" text-anchor="middle" fill="#10b981" font-family="Arial, sans-serif">Memory-bound</text>
  
  <!-- Arrow 4 -->
  <line x1="920" y1="160" x2="970" y2="160" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 5: Batching & Shuffling -->
  <rect x="970" y="100" width="180" height="120" rx="8" fill="#dbeafe" stroke="#667eea" stroke-width="2"/>
  <text x="1060" y="135" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Batching</text>
  <text x="1060" y="160" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Shuffling</text>
  <text x="1060" y="185" font-size="13" text-anchor="middle" fill="#4b5563" font-family="Arial, sans-serif">50-500 GB/hr</text>
  <text x="1060" y="205" font-size="12" text-anchor="middle" fill="#667eea" font-family="Arial, sans-serif">I/O-bound</text>
  
  <!-- Arrow 5 -->
  <line x1="1150" y1="160" x2="1200" y2="160" stroke="#667eea" stroke-width="2" marker-end="url(#arrowhead)"/>
  
  <!-- Stage 6: Training -->
  <rect x="1200" y="100" width="150" height="120" rx="8" fill="#e9d5ff" stroke="#764ba2" stroke-width="2"/>
  <text x="1275" y="150" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">GPU</text>
  <text x="1275" y="175" font-size="16" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">Training</text>
  <text x="1275" y="200" font-size="12" text-anchor="middle" fill="#764ba2" font-family="Arial, sans-serif">Compute</text>
  
  <!-- Bottleneck Details Section -->
  <rect x="50" y="280" width="1300" height="280" rx="8" fill="#f9fafb" stroke="#d1d5db" stroke-width="2"/>
  <text x="700" y="315" font-size="18" font-weight="bold" text-anchor="middle" fill="#1f2937" font-family="Arial, sans-serif">
    Pipeline Bottleneck Analysis
  </text>
  
  <!-- Disk I/O Bottleneck -->
  <rect x="80" y="340" width="360" height="200" rx="6" fill="#fff" stroke="#667eea" stroke-width="2"/>
  <text x="260" y="370" font-size="15" font-weight="bold" text-anchor="middle" fill="#667eea" font-family="Arial, sans-serif">
    Disk I/O Bottleneck
  </text>
  <text x="100" y="400" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">SSD: 500-3,000 MB/s</text>
  <text x="100" y="425" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">HDD: 100-200 MB/s</text>
  <text x="100" y="450" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">Limits large datasets</text>
  <text x="100" y="480" font-size="13" font-weight="bold" fill="#10b981" font-family="Arial, sans-serif">Solutions:</text>
  <text x="100" y="505" font-size="12" fill="#6b7280" font-family="Arial, sans-serif">- Parallel loading</text>
  <text x="100" y="525" font-size="12" fill="#6b7280" font-family="Arial, sans-serif">- In-memory caching</text>
  
  <!-- CPU Processing Bottleneck -->
  <rect x="470" y="340" width="360" height="200" rx="6" fill="#fff" stroke="#f59e0b" stroke-width="2"/>
  <text x="650" y="370" font-size="15" font-weight="bold" text-anchor="middle" fill="#f59e0b" font-family="Arial, sans-serif">
    CPU Processing Bottleneck
  </text>
  <text x="490" y="400" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">Single-thread: 1-10 GB/hr</text>
  <text x="490" y="425" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">Tokenization, filtering</text>
  <text x="490" y="450" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">GPU sits idle</text>
  <text x="490" y="480" font-size="13" font-weight="bold" fill="#10b981" font-family="Arial, sans-serif">Solutions:</text>
  <text x="490" y="505" font-size="12" fill="#6b7280" font-family="Arial, sans-serif">- Multiprocessing (4-8 workers)</text>
  <text x="490" y="525" font-size="12" fill="#6b7280" font-family="Arial, sans-serif">- Vectorized operations</text>
  
  <!-- Memory Bandwidth -->
  <rect x="860" y="340" width="460" height="200" rx="6" fill="#fff" stroke="#10b981" stroke-width="2"/>
  <text x="1090" y="370" font-size="15" font-weight="bold" text-anchor="middle" fill="#10b981" font-family="Arial, sans-serif">
    Memory Bandwidth
  </text>
  <text x="880" y="400" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">PCIe 3.0: ~12 GB/s (CPU-GPU)</text>
  <text x="880" y="425" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">PCIe 4.0: ~24 GB/s (CPU-GPU)</text>
  <text x="880" y="450" font-size="13" fill="#4b5563" font-family="Arial, sans-serif">Limits: Small batches, frequent transfers</text>
  <text x="880" y="480" font-size="13" font-weight="bold" fill="#10b981" font-family="Arial, sans-serif">Solutions:</text>
  <text x="880" y="505" font-size="12" fill="#6b7280" font-family="Arial, sans-serif">- Larger batches (amortize overhead)</text>
  <text x="880" y="525" font-size="12" fill="#6b7280" font-family="Arial, sans-serif">- Prefetching (overlap transfer)</text>
</svg>