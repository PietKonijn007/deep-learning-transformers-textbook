<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1400 900">
  <defs>
    <linearGradient id="grad1" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#667eea;stop-opacity:0.2" />
      <stop offset="100%" style="stop-color:#667eea;stop-opacity:0.05" />
    </linearGradient>
    <linearGradient id="grad2" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#764ba2;stop-opacity:0.2" />
      <stop offset="100%" style="stop-color:#764ba2;stop-opacity:0.05" />
    </linearGradient>
    <linearGradient id="grad3" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#f093fb;stop-opacity:0.2" />
      <stop offset="100%" style="stop-color:#f093fb;stop-opacity:0.05" />
    </linearGradient>
  </defs>
  
  <!-- Title -->
  <text x="700" y="40" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#2d3748">
    TabTransformer for Credit Risk Assessment
  </text>
  <text x="700" y="65" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#718096">
    15M Parameters • 5ms Latency • 100 Features (40 Categorical + 60 Continuous)
  </text>
  
  <!-- Input Layer - Categorical Features -->
  <rect x="50" y="120" width="280" height="220" rx="8" fill="url(#grad1)" stroke="#667eea" stroke-width="2"/>
  <text x="190" y="150" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Categorical Features (40)
  </text>
  
  <rect x="70" y="170" width="120" height="35" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1"/>
  <text x="130" y="193" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Merchant Category</text>
  
  <rect x="200" y="170" width="110" height="35" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1"/>
  <text x="255" y="193" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Device Type</text>
  
  <rect x="70" y="215" width="120" height="35" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1"/>
  <text x="130" y="238" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Transaction Location</text>
  
  <rect x="200" y="215" width="110" height="35" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1"/>
  <text x="255" y="238" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Account Age</text>
  
  <rect x="70" y="260" width="120" height="35" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1"/>
  <text x="130" y="283" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Payment Method</text>
  
  <rect x="200" y="260" width="110" height="35" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1"/>
  <text x="255" y="283" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Time of Day</text>
  
  <text x="190" y="320" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#718096">+ 34 more categorical features</text>
  
  <!-- Input Layer - Continuous Features -->
  <rect x="370" y="120" width="280" height="220" rx="8" fill="url(#grad2)" stroke="#764ba2" stroke-width="2"/>
  <text x="510" y="150" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Continuous Features (60)
  </text>
  
  <rect x="390" y="170" width="110" height="35" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1"/>
  <text x="445" y="193" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Amount</text>
  
  <rect x="510" y="170" width="120" height="35" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1"/>
  <text x="570" y="193" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Account Balance</text>
  
  <rect x="390" y="215" width="110" height="35" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1"/>
  <text x="445" y="238" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Credit Score</text>
  
  <rect x="510" y="215" width="120" height="35" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1"/>
  <text x="570" y="238" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Credit Utilization</text>
  
  <rect x="390" y="260" width="110" height="35" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1"/>
  <text x="445" y="283" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Velocity</text>
  
  <rect x="510" y="260" width="120" height="35" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1"/>
  <text x="570" y="283" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#2d3748">Recent Patterns</text>
  
  <text x="510" y="320" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#718096">+ 54 more continuous features</text>
  
  <!-- Arrows down -->
  <path d="M 190 340 L 190 380" stroke="#667eea" stroke-width="2" fill="none" marker-end="url(#arrowhead1)"/>
  <path d="M 510 340 L 510 380" stroke="#764ba2" stroke-width="2" fill="none" marker-end="url(#arrowhead2)"/>
  
  <!-- Embedding Layer -->
  <rect x="50" y="380" width="280" height="100" rx="8" fill="url(#grad1)" stroke="#667eea" stroke-width="2"/>
  <text x="190" y="410" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Embedding Layer
  </text>
  <text x="190" y="435" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#4a5568">
    32-Dimensional Embeddings
  </text>
  <text x="190" y="455" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#718096">
    40 × 32 = 1,280 dimensions
  </text>
  
  <!-- Feed-Forward Network -->
  <rect x="370" y="380" width="280" height="100" rx="8" fill="url(#grad2)" stroke="#764ba2" stroke-width="2"/>
  <text x="510" y="410" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Feed-Forward Network
  </text>
  <text x="510" y="435" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#4a5568">
    Dense Layers
  </text>
  <text x="510" y="455" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#718096">
    60 continuous features
  </text>
  
  <!-- Arrows to Self-Attention -->
  <path d="M 190 480 L 190 520" stroke="#667eea" stroke-width="2" fill="none" marker-end="url(#arrowhead1)"/>
  
  <!-- Self-Attention Layers -->
  <rect x="50" y="520" width="280" height="180" rx="8" fill="url(#grad3)" stroke="#f093fb" stroke-width="2"/>
  <text x="190" y="550" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Self-Attention Layers
  </text>
  <text x="190" y="570" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#4a5568">
    6 Layers × 8 Heads
  </text>
  
  <!-- Attention visualization -->
  <g transform="translate(70, 590)">
    <!-- Layer boxes -->
    <rect x="0" y="0" width="35" height="25" rx="3" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="17.5" y="16" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f093fb">L1</text>
    
    <rect x="45" y="0" width="35" height="25" rx="3" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="62.5" y="16" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f093fb">L2</text>
    
    <rect x="90" y="0" width="35" height="25" rx="3" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="107.5" y="16" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f093fb">L3</text>
    
    <rect x="135" y="0" width="35" height="25" rx="3" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="152.5" y="16" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f093fb">L4</text>
    
    <rect x="180" y="0" width="35" height="25" rx="3" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="197.5" y="16" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f093fb">L5</text>
    
    <rect x="225" y="0" width="35" height="25" rx="3" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="242.5" y="16" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#f093fb">L6</text>
  </g>
  
  <!-- Attention heads -->
  <g transform="translate(90, 630)">
    <circle cx="0" cy="0" r="12" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="0" y="4" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#f093fb">H1</text>
    
    <circle cx="25" cy="0" r="12" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="25" y="4" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#f093fb">H2</text>
    
    <circle cx="50" cy="0" r="12" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="50" y="4" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#f093fb">H3</text>
    
    <text x="75" y="4" font-family="Arial, sans-serif" font-size="10" text-anchor="middle" fill="#718096">...</text>
    
    <circle cx="100" cy="0" r="12" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
    <text x="100" y="4" font-family="Arial, sans-serif" font-size="9" text-anchor="middle" fill="#f093fb">H8</text>
  </g>
  
  <text x="190" y="675" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#718096">
    Feature Interaction Learning
  </text>
  
  <!-- Arrow to Fusion -->
  <path d="M 190 700 L 190 740" stroke="#f093fb" stroke-width="2" fill="none" marker-end="url(#arrowhead3)"/>
  <path d="M 510 480 L 510 610 L 350 610 L 350 740" stroke="#764ba2" stroke-width="2" fill="none" marker-end="url(#arrowhead2)"/>
  
  <!-- Fusion Layer -->
  <rect x="50" y="740" width="600" height="80" rx="8" fill="url(#grad1)" stroke="#667eea" stroke-width="2"/>
  <text x="350" y="770" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Fusion Layer
  </text>
  <text x="350" y="795" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#4a5568">
    Combine Categorical Embeddings and Continuous Features
  </text>
  
  <!-- Arrow to Output -->
  <path d="M 350 820 L 350 860" stroke="#667eea" stroke-width="2" fill="none" marker-end="url(#arrowhead1)"/>
  
  <!-- Output Layer -->
  <rect x="700" y="380" width="280" height="440" rx="8" fill="url(#grad3)" stroke="#f093fb" stroke-width="2"/>
  <text x="840" y="410" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Output and Explainability
  </text>
  
  <!-- Fraud Probability -->
  <rect x="720" y="430" width="240" height="90" rx="6" fill="#ffffff" stroke="#f093fb" stroke-width="2"/>
  <text x="840" y="455" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Fraud Probability
  </text>
  <text x="840" y="480" font-family="Arial, sans-serif" font-size="20" font-weight="bold" text-anchor="middle" fill="#f093fb">
    0.87
  </text>
  <text x="840" y="505" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#718096">
    High Risk - Flag for Review
  </text>
  
  <!-- SHAP Explanations -->
  <rect x="720" y="540" width="240" height="120" rx="6" fill="#ffffff" stroke="#667eea" stroke-width="2"/>
  <text x="840" y="565" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2d3748">
    SHAP Explanations
  </text>
  <text x="750" y="590" font-family="Arial, sans-serif" font-size="11" text-anchor="start" fill="#4a5568">
    Credit Utilization: +0.30
  </text>
  <text x="750" y="610" font-family="Arial, sans-serif" font-size="11" text-anchor="start" fill="#4a5568">
    Recent Inquiries: +0.20
  </text>
  <text x="750" y="630" font-family="Arial, sans-serif" font-size="11" text-anchor="start" fill="#4a5568">
    Transaction Velocity: +0.40
  </text>
  <text x="750" y="650" font-family="Arial, sans-serif" font-size="11" text-anchor="start" fill="#718096">
    Device Fingerprint: -0.15
  </text>
  
  <!-- Fairness Constraints -->
  <rect x="720" y="680" width="240" height="120" rx="6" fill="#ffffff" stroke="#764ba2" stroke-width="2"/>
  <text x="840" y="705" font-family="Arial, sans-serif" font-size="14" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Fairness Constraints
  </text>
  <text x="840" y="730" font-family="Arial, sans-serif" font-size="12" text-anchor="middle" fill="#4a5568">
    Disparate Impact Ratio
  </text>
  <text x="840" y="755" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#764ba2">
    0.85
  </text>
  <text x="840" y="780" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#718096">
    Meets 80% Rule (>0.80)
  </text>
  
  <!-- Arrow from Fusion to Output -->
  <path d="M 650 780 L 700 780" stroke="#667eea" stroke-width="2" fill="none" marker-end="url(#arrowhead1)"/>
  
  <!-- Performance Metrics Box -->
  <rect x="1020" y="120" width="330" height="700" rx="8" fill="#f7fafc" stroke="#e2e8f0" stroke-width="2"/>
  <text x="1185" y="155" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Model Performance
  </text>
  
  <!-- Metrics -->
  <rect x="1050" y="180" width="270" height="70" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1.5"/>
  <text x="1185" y="205" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    AUC Improvement
  </text>
  <text x="1185" y="230" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#667eea">
    0.78 → 0.85
  </text>
  
  <rect x="1050" y="265" width="270" height="70" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1.5"/>
  <text x="1185" y="290" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Fraud Recall
  </text>
  <text x="1185" y="315" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#764ba2">
    88%
  </text>
  
  <rect x="1050" y="350" width="270" height="70" rx="4" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
  <text x="1185" y="375" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Prevented Losses
  </text>
  <text x="1185" y="400" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#f093fb">
    $1.68M/year
  </text>
  
  <rect x="1050" y="435" width="270" height="70" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1.5"/>
  <text x="1185" y="460" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Inference Latency
  </text>
  <text x="1185" y="485" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#667eea">
    5ms (CPU)
  </text>
  
  <rect x="1050" y="520" width="270" height="70" rx="4" fill="#ffffff" stroke="#764ba2" stroke-width="1.5"/>
  <text x="1185" y="545" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Model Size
  </text>
  <text x="1185" y="570" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#764ba2">
    15M Parameters
  </text>
  
  <rect x="1050" y="605" width="270" height="70" rx="4" fill="#ffffff" stroke="#f093fb" stroke-width="1.5"/>
  <text x="1185" y="630" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Training Time
  </text>
  <text x="1185" y="655" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#f093fb">
    2-3 hours
  </text>
  
  <rect x="1050" y="690" width="270" height="110" rx="4" fill="#ffffff" stroke="#667eea" stroke-width="1.5"/>
  <text x="1185" y="715" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#2d3748">
    Deployment Strategy
  </text>
  <text x="1185" y="740" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#4a5568">
    Shadow → 50% A/B → Full
  </text>
  <text x="1185" y="760" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#718096">
    2-4 weeks per phase
  </text>
  <text x="1185" y="780" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#718096">
    Gradual risk management
  </text>
  
  <!-- Arrow marker definitions -->
  <defs>
    <marker id="arrowhead1" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#667eea" />
    </marker>
    <marker id="arrowhead2" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#764ba2" />
    </marker>
    <marker id="arrowhead3" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#f093fb" />
    </marker>
  </defs>
</svg>
