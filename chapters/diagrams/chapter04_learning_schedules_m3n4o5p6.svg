<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 700">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #2d3748; }
      .label { font: 16px sans-serif; fill: #2d3748; }
      .small-label { font: 14px sans-serif; fill: #4a5568; }
      .annotation { font: 13px sans-serif; fill: #718096; }
      .axis-label { font: 14px sans-serif; fill: #2d3748; }
      .grid-line { stroke: #e2e8f0; stroke-width: 1; }
      .cosine-curve { stroke: #667eea; stroke-width: 3; fill: none; }
      .linear-curve { stroke: #48bb78; stroke-width: 3; fill: none; }
      .invsqrt-curve { stroke: #f093fb; stroke-width: 3; fill: none; }
      .warmup-region { fill: #fef5e7; opacity: 0.5; }
    </style>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" class="title" text-anchor="middle">Learning Rate Schedules for Transformer Training</text>
  
  <!-- Graph area -->
  <g transform="translate(100, 80)">
    <!-- Grid lines -->
    <line x1="0" y1="450" x2="1000" y2="450" class="grid-line"/>
    <line x1="0" y1="360" x2="1000" y2="360" class="grid-line"/>
    <line x1="0" y1="270" x2="1000" y2="270" class="grid-line"/>
    <line x1="0" y1="180" x2="1000" y2="180" class="grid-line"/>
    <line x1="0" y1="90" x2="1000" y2="90" class="grid-line"/>
    <line x1="0" y1="0" x2="1000" y2="0" class="grid-line"/>
    
    <!-- Vertical grid lines -->
    <line x1="100" y1="0" x2="100" y2="450" class="grid-line"/>
    <line x1="250" y1="0" x2="250" y2="450" class="grid-line"/>
    <line x1="500" y1="0" x2="500" y2="450" class="grid-line"/>
    <line x1="750" y1="0" x2="750" y2="450" class="grid-line"/>
    <line x1="1000" y1="0" x2="1000" y2="450" class="grid-line"/>
    
    <!-- Warmup region highlight -->
    <rect x="0" y="0" width="100" height="450" class="warmup-region"/>
    <text x="50" y="470" class="annotation" text-anchor="middle">Warmup</text>
    <text x="50" y="490" class="annotation" text-anchor="middle">Phase</text>
    
    <!-- Axes -->
    <line x1="0" y1="0" x2="0" y2="450" stroke="#2d3748" stroke-width="2"/>
    <line x1="0" y1="450" x2="1000" y2="450" stroke="#2d3748" stroke-width="2"/>
    
    <!-- Y-axis labels -->
    <text x="-15" y="455" class="axis-label" text-anchor="end">0</text>
    <text x="-15" y="365" class="axis-label" text-anchor="end">2e-4</text>
    <text x="-15" y="275" class="axis-label" text-anchor="end">4e-4</text>
    <text x="-15" y="185" class="axis-label" text-anchor="end">6e-4</text>
    <text x="-15" y="95" class="axis-label" text-anchor="end">8e-4</text>
    <text x="-15" y="5" class="axis-label" text-anchor="end">1e-3</text>
    
    <!-- X-axis labels -->
    <text x="0" y="480" class="axis-label" text-anchor="middle">0</text>
    <text x="100" y="480" class="axis-label" text-anchor="middle">10K</text>
    <text x="250" y="480" class="axis-label" text-anchor="middle">25K</text>
    <text x="500" y="480" class="axis-label" text-anchor="middle">50K</text>
    <text x="750" y="480" class="axis-label" text-anchor="middle">75K</text>
    <text x="1000" y="480" class="axis-label" text-anchor="middle">100K</text>
    
    <!-- Axis titles -->
    <text x="500" y="520" class="label" text-anchor="middle">Training Steps</text>
    <text x="-60" y="225" class="label" text-anchor="middle" transform="rotate(-90, -60, 225)">Learning Rate</text>
    
    <!-- Cosine Decay Curve -->
    <clipPath id="graph-clip">
      <rect x="0" y="0" width="1000" height="450"/>
    </clipPath>
    
    <g clip-path="url(#graph-clip)">
      <!-- Warmup phase (all curves) -->
      <path d="M 0 450 L 100 90" class="cosine-curve"/>
      <path d="M 0 450 L 100 90" class="linear-curve"/>
      <path d="M 0 450 L 100 90" class="invsqrt-curve"/>
      
      <!-- Cosine decay -->
      <path d="M 100 90 Q 300 90, 400 150 Q 600 250, 800 350 Q 900 400, 1000 440" class="cosine-curve"/>
      
      <!-- Linear decay -->
      <path d="M 100 90 L 1000 440" class="linear-curve"/>
      
      <!-- Inverse sqrt decay -->
      <path d="M 100 90 Q 200 150, 300 200 Q 500 270, 700 320 Q 850 350, 1000 370" class="invsqrt-curve"/>
    </g>
    
    <!-- Peak point marker -->
    <circle cx="100" cy="90" r="5" fill="#e53e3e"/>
    <text x="100" y="75" class="annotation" text-anchor="middle">Peak LR</text>
    <text x="100" y="60" class="annotation" text-anchor="middle">(1e-3)</text>
    
    <!-- Legend -->
    <g transform="translate(700, 30)">
      <rect x="0" y="0" width="250" height="120" fill="white" stroke="#cbd5e0" stroke-width="1" rx="5"/>
      
      <line x1="20" y1="30" x2="70" y2="30" class="cosine-curve"/>
      <text x="80" y="35" class="small-label">Cosine Decay</text>
      <text x="80" y="50" class="annotation">(Most common)</text>
      
      <line x1="20" y1="70" x2="70" y2="70" class="linear-curve"/>
      <text x="80" y="75" class="small-label">Linear Decay</text>
      
      <line x1="20" y1="100" x2="70" y2="100" class="invsqrt-curve"/>
      <text x="80" y="105" class="small-label">Inverse Sqrt Decay</text>
    </g>
  </g>
  
  <!-- Bottom annotations -->
  <rect x="50" y="620" width="1100" height="60" fill="#f7fafc" stroke="#cbd5e0" stroke-width="1" rx="5"/>
  <text x="600" y="645" class="annotation" text-anchor="middle">Warmup Phase: Prevents early training instability (typically 1-10% of total steps)</text>
  <text x="600" y="665" class="annotation" text-anchor="middle">Decay Phase: Cosine decay typically provides 1-3% better final performance than constant LR</text>
</svg>
