<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 600">
  <defs>
    <marker id="forward" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#333"/>
    </marker>
    <marker id="backward" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#f44336"/>
    </marker>
  </defs>
  
  <!-- Background -->
  <rect width="1200" height="600" fill="#ffffff"/>
  
  <!-- Title -->
  <text x="600" y="35" font-family="Arial, sans-serif" font-size="22" font-weight="bold" text-anchor="middle" fill="#1a1a1a">
    Backpropagation Computational Graph
  </text>
  
  <!-- Forward Pass Label -->
  <text x="600" y="80" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#333">
    Forward Pass →
  </text>
  
  <!-- Backward Pass Label -->
  <text x="600" y="480" font-family="Arial, sans-serif" font-size="16" font-weight="bold" text-anchor="middle" fill="#f44336">
    ← Backward Pass (Backpropagation)
  </text>
  
  <!-- Nodes (circles) -->
  <circle cx="150" cy="250" r="40" fill="#e3f2fd" stroke="#1976d2" stroke-width="3"/>
  <text x="150" y="260" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#1976d2">x</text>
  
  <circle cx="350" cy="250" r="40" fill="#e8f5e9" stroke="#4caf50" stroke-width="3"/>
  <text x="350" y="260" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#4caf50">h</text>
  
  <circle cx="550" cy="250" r="40" fill="#fff3e0" stroke="#ff9800" stroke-width="3"/>
  <text x="550" y="260" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#ff9800">a</text>
  
  <circle cx="750" cy="250" r="40" fill="#f3e5f5" stroke="#9c27b0" stroke-width="3"/>
  <text x="750" y="260" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#9c27b0">y</text>
  
  <circle cx="950" cy="250" r="40" fill="#ffebee" stroke="#e53935" stroke-width="3"/>
  <text x="950" y="260" font-family="Arial, sans-serif" font-size="18" font-weight="bold" text-anchor="middle" fill="#e53935">L</text>
  
  <!-- Forward edges (solid black) -->
  <line x1="190" y1="250" x2="310" y2="250" stroke="#333" stroke-width="3" marker-end="url(#forward)"/>
  <line x1="390" y1="250" x2="510" y2="250" stroke="#333" stroke-width="3" marker-end="url(#forward)"/>
  <line x1="590" y1="250" x2="710" y2="250" stroke="#333" stroke-width="3" marker-end="url(#forward)"/>
  <line x1="790" y1="250" x2="910" y2="250" stroke="#333" stroke-width="3" marker-end="url(#forward)"/>
  
  <!-- Forward edge labels -->
  <text x="250" y="230" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#333">
    W₁x
  </text>
  <text x="450" y="230" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#333">
    σ(h)
  </text>
  <text x="650" y="230" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#333">
    W₂a
  </text>
  <text x="850" y="230" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#333">
    ℓ(y, y_true)
  </text>
  
  <!-- Backward edges (dashed red) -->
  <line x1="910" y1="270" x2="790" y2="270" stroke="#f44336" stroke-width="3" stroke-dasharray="8,4" marker-end="url(#backward)"/>
  <line x1="710" y1="270" x2="590" y2="270" stroke="#f44336" stroke-width="3" stroke-dasharray="8,4" marker-end="url(#backward)"/>
  <line x1="510" y1="270" x2="390" y2="270" stroke="#f44336" stroke-width="3" stroke-dasharray="8,4" marker-end="url(#backward)"/>
  <line x1="310" y1="270" x2="190" y2="270" stroke="#f44336" stroke-width="3" stroke-dasharray="8,4" marker-end="url(#backward)"/>
  
  <!-- Backward edge labels -->
  <text x="850" y="300" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#f44336">
    ∂L/∂y
  </text>
  <text x="650" y="300" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#f44336">
    ∂L/∂a
  </text>
  <text x="450" y="300" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#f44336">
    ∂L/∂h
  </text>
  <text x="250" y="300" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#f44336">
    ∂L/∂x
  </text>
  
  <!-- Node descriptions -->
  <text x="150" y="210" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Input
  </text>
  <text x="350" y="210" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Hidden
  </text>
  <text x="550" y="210" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Activation
  </text>
  <text x="750" y="210" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Output
  </text>
  <text x="950" y="210" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#666">
    Loss
  </text>
  
  <!-- Chain rule annotation -->
  <rect x="300" y="360" width="600" height="80" fill="#fff9c4" stroke="#f57f17" stroke-width="2" rx="5"/>
  <text x="600" y="390" font-family="Arial, sans-serif" font-size="15" font-weight="bold" text-anchor="middle" fill="#333">
    Chain Rule Application
  </text>
  <text x="600" y="415" font-family="Arial, sans-serif" font-size="14" text-anchor="middle" fill="#333">
    ∂L/∂W₁ = ∂L/∂h × ∂h/∂W₁
  </text>
  
  <!-- Complexity note -->
  <rect x="50" y="360" width="200" height="60" fill="#e8f5e9" stroke="#4caf50" stroke-width="2" rx="5"/>
  <text x="150" y="385" font-family="Arial, sans-serif" font-size="13" font-weight="bold" text-anchor="middle" fill="#333">
    Complexity
  </text>
  <text x="150" y="408" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#333">
    O(n) for n operations
  </text>
  
  <!-- Key insight -->
  <rect x="950" y="360" width="200" height="80" fill="#f3e5f5" stroke="#9c27b0" stroke-width="2" rx="5"/>
  <text x="1050" y="385" font-family="Arial, sans-serif" font-size="12" font-weight="bold" text-anchor="middle" fill="#333">
    Key Insight
  </text>
  <text x="1050" y="405" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">
    Each edge traversed
  </text>
  <text x="1050" y="422" font-family="Arial, sans-serif" font-size="11" text-anchor="middle" fill="#333">
    exactly once
  </text>
  
  <!-- Bottom note -->
  <text x="600" y="550" font-family="Arial, sans-serif" font-size="13" text-anchor="middle" fill="#666" font-style="italic">
    Forward pass computes outputs; backward pass computes gradients using chain rule
  </text>
</svg>
