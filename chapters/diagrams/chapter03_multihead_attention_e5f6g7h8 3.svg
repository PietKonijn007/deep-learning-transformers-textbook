<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 800">
  <defs>
    <style>
      .title { font: bold 20px sans-serif; fill: #2d3748; }
      .label { font: 16px sans-serif; fill: #2d3748; }
      .small-label { font: 14px sans-serif; fill: #4a5568; }
      .tiny-label { font: 12px sans-serif; fill: #4a5568; }
      .annotation { font: 13px sans-serif; fill: #718096; }
      .box { fill: #667eea; stroke: #4c51bf; stroke-width: 2; }
      .head1 { fill: #667eea; stroke: #4c51bf; stroke-width: 1.5; }
      .head2 { fill: #764ba2; stroke: #553c9a; stroke-width: 1.5; }
      .head3 { fill: #f093fb; stroke: #e879f9; stroke-width: 1.5; }
      .arrow { stroke: #4a5568; stroke-width: 2; fill: none; marker-end: url(#arrowhead); }
      .arrow-thin { stroke: #718096; stroke-width: 1; fill: none; marker-end: url(#arrowhead-small); }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4a5568" />
    </marker>
    <marker id="arrowhead-small" markerWidth="8" markerHeight="8" refX="7" refY="2.5" orient="auto">
      <polygon points="0 0, 8 2.5, 0 5" fill="#718096" />
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="600" y="30" class="title" text-anchor="middle">Multi-Head Attention: Parallel Computation</text>
  
  <!-- Input -->
  <rect x="450" y="60" width="300" height="50" class="box" rx="5"/>
  <text x="600" y="90" class="label" text-anchor="middle">Input (512 × 768)</text>
  
  <!-- Split arrows -->
  <path d="M 500 110 L 150 160" class="arrow"/>
  <path d="M 550 110 L 350 160" class="arrow"/>
  <path d="M 650 110 L 550 160" class="arrow"/>
  <path d="M 700 110 L 750 160" class="arrow"/>
  <path d="M 750 110 L 1050 160" class="arrow"/>
  
  <!-- Head 1 -->
  <g transform="translate(50, 160)">
    <rect x="0" y="0" width="200" height="280" class="head1" rx="5"/>
    <text x="100" y="25" class="label" text-anchor="middle">Head 1</text>
    
    <rect x="20" y="40" width="160" height="35" fill="#e6fffa" stroke="#81e6d9" stroke-width="1" rx="3"/>
    <text x="100" y="62" class="tiny-label" text-anchor="middle">Q/K/V (64 dims)</text>
    
    <rect x="40" y="90" width="120" height="80" fill="#fef5e7" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="100" y="115" class="tiny-label" text-anchor="middle">Attention</text>
    <text x="100" y="135" class="tiny-label" text-anchor="middle">512×512</text>
    
    <rect x="20" y="185" width="160" height="35" fill="#e8f5e9" stroke="#66bb6a" stroke-width="1" rx="3"/>
    <text x="100" y="207" class="tiny-label" text-anchor="middle">Output (512×64)</text>
    
    <text x="100" y="245" class="annotation" text-anchor="middle">64 dimensions</text>
    <text x="100" y="265" class="annotation" text-anchor="middle">per head</text>
  </g>
  
  <!-- Head 2 -->
  <g transform="translate(270, 160)">
    <rect x="0" y="0" width="200" height="280" class="head2" rx="5"/>
    <text x="100" y="25" class="label" text-anchor="middle">Head 2</text>
    
    <rect x="20" y="40" width="160" height="35" fill="#e6fffa" stroke="#81e6d9" stroke-width="1" rx="3"/>
    <text x="100" y="62" class="tiny-label" text-anchor="middle">Q/K/V (64 dims)</text>
    
    <rect x="40" y="90" width="120" height="80" fill="#fef5e7" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="100" y="115" class="tiny-label" text-anchor="middle">Attention</text>
    <text x="100" y="135" class="tiny-label" text-anchor="middle">512×512</text>
    
    <rect x="20" y="185" width="160" height="35" fill="#e8f5e9" stroke="#66bb6a" stroke-width="1" rx="3"/>
    <text x="100" y="207" class="tiny-label" text-anchor="middle">Output (512×64)</text>
  </g>
  
  <!-- Head 3 -->
  <g transform="translate(490, 160)">
    <rect x="0" y="0" width="200" height="280" class="head3" rx="5"/>
    <text x="100" y="25" class="label" text-anchor="middle">Head 3</text>
    
    <rect x="20" y="40" width="160" height="35" fill="#e6fffa" stroke="#81e6d9" stroke-width="1" rx="3"/>
    <text x="100" y="62" class="tiny-label" text-anchor="middle">Q/K/V (64 dims)</text>
    
    <rect x="40" y="90" width="120" height="80" fill="#fef5e7" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="100" y="115" class="tiny-label" text-anchor="middle">Attention</text>
    <text x="100" y="135" class="tiny-label" text-anchor="middle">512×512</text>
    
    <rect x="20" y="185" width="160" height="35" fill="#e8f5e9" stroke="#66bb6a" stroke-width="1" rx="3"/>
    <text x="100" y="207" class="tiny-label" text-anchor="middle">Output (512×64)</text>
  </g>
  
  <!-- Ellipsis -->
  <text x="730" y="300" class="title" text-anchor="middle">...</text>
  
  <!-- Head 12 -->
  <g transform="translate(800, 160)">
    <rect x="0" y="0" width="200" height="280" class="head1" rx="5"/>
    <text x="100" y="25" class="label" text-anchor="middle">Head 12</text>
    
    <rect x="20" y="40" width="160" height="35" fill="#e6fffa" stroke="#81e6d9" stroke-width="1" rx="3"/>
    <text x="100" y="62" class="tiny-label" text-anchor="middle">Q/K/V (64 dims)</text>
    
    <rect x="40" y="90" width="120" height="80" fill="#fef5e7" stroke="#f39c12" stroke-width="1" rx="3"/>
    <text x="100" y="115" class="tiny-label" text-anchor="middle">Attention</text>
    <text x="100" y="135" class="tiny-label" text-anchor="middle">512×512</text>
    
    <rect x="20" y="185" width="160" height="35" fill="#e8f5e9" stroke="#66bb6a" stroke-width="1" rx="3"/>
    <text x="100" y="207" class="tiny-label" text-anchor="middle">Output (512×64)</text>
  </g>
  
  <!-- Arrows to concatenate -->
  <path d="M 150 440 L 500 520" class="arrow"/>
  <path d="M 370 440 L 500 520" class="arrow"/>
  <path d="M 590 440 L 550 520" class="arrow"/>
  <path d="M 900 440 L 600 520" class="arrow"/>
  
  <!-- Concatenate box -->
  <rect x="400" y="520" width="200" height="60" class="box" rx="5"/>
  <text x="500" y="545" class="label" text-anchor="middle">Concatenate</text>
  <text x="500" y="565" class="small-label" text-anchor="middle">12 × 64 = 768 dims</text>
  
  <!-- Arrow to output -->
  <path d="M 500 580 L 500 640" class="arrow"/>
  
  <!-- Output -->
  <rect x="400" y="640" width="200" height="50" class="box" rx="5"/>
  <text x="500" y="670" class="label" text-anchor="middle">Output (512 × 768)</text>
  
  <!-- Annotations -->
  <text x="50" y="500" class="annotation">12 heads × 64 dims = 768 total</text>
  <text x="1020" y="300" class="annotation">Parallel execution</text>
  <text x="1020" y="320" class="annotation">on GPU</text>
  <text x="400" y="730" class="annotation">Same total computation as single head</text>
</svg>
