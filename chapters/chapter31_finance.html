<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chapter 31: Financial Applications - Deep Learning and Transformers</title>
    <link rel="stylesheet" href="../../styles.css">
    
    <!-- MathJax Configuration (must come before loading MathJax) -->
    <script>
    window.MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']],
            displayMath: [['$$', '$$'], ['\\[', '\\]']],
            processEscapes: true,
            processEnvironments: true,
            tags: 'ams',
            macros: {
                R: '{\\mathbb{R}}',
                N: '{\\mathbb{N}}',
                Z: '{\\mathbb{Z}}',
                C: '{\\mathbb{C}}',
                va: '{\\mathbf{a}}',
                vb: '{\\mathbf{b}}',
                vc: '{\\mathbf{c}}',
                vd: '{\\mathbf{d}}',
                ve: '{\\mathbf{e}}',
                vf: '{\\mathbf{f}}',
                vg: '{\\mathbf{g}}',
                vh: '{\\mathbf{h}}',
                vi: '{\\mathbf{i}}',
                vj: '{\\mathbf{j}}',
                vk: '{\\mathbf{k}}',
                vl: '{\\mathbf{l}}',
                vm: '{\\mathbf{m}}',
                vn: '{\\mathbf{n}}',
                vo: '{\\mathbf{o}}',
                vp: '{\\mathbf{p}}',
                vq: '{\\mathbf{q}}',
                vr: '{\\mathbf{r}}',
                vs: '{\\mathbf{s}}',
                vt: '{\\mathbf{t}}',
                vu: '{\\mathbf{u}}',
                vv: '{\\mathbf{v}}',
                vw: '{\\mathbf{w}}',
                vx: '{\\mathbf{x}}',
                vy: '{\\mathbf{y}}',
                vz: '{\\mathbf{z}}',
                mA: '{\\mathbf{A}}',
                mB: '{\\mathbf{B}}',
                mC: '{\\mathbf{C}}',
                mD: '{\\mathbf{D}}',
                mE: '{\\mathbf{E}}',
                mF: '{\\mathbf{F}}',
                mG: '{\\mathbf{G}}',
                mH: '{\\mathbf{H}}',
                mI: '{\\mathbf{I}}',
                mJ: '{\\mathbf{J}}',
                mK: '{\\mathbf{K}}',
                mL: '{\\mathbf{L}}',
                mM: '{\\mathbf{M}}',
                mN: '{\\mathbf{N}}',
                mO: '{\\mathbf{O}}',
                mP: '{\\mathbf{P}}',
                mQ: '{\\mathbf{Q}}',
                mR: '{\\mathbf{R}}',
                mS: '{\\mathbf{S}}',
                mT: '{\\mathbf{T}}',
                mU: '{\\mathbf{U}}',
                mV: '{\\mathbf{V}}',
                mW: '{\\mathbf{W}}',
                mX: '{\\mathbf{X}}',
                mY: '{\\mathbf{Y}}',
                mZ: '{\\mathbf{Z}}',
                transpose: '{^\\top}',
                norm: ['\\left\\|#1\\right\\|', 1],
                abs: ['\\left|#1\\right|', 1]
            }
        },
        startup: {
            pageReady: () => {
                console.log('MathJax loaded and ready');
                return MathJax.startup.defaultPageReady();
            }
        }
    };
    </script>
    <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
</head>
<body>
    <nav>
        <a href="../../deeptech.html">üè† Home</a>
        <a href="preface.html">Preface</a>
        <a href="notation.html">Notation</a>
        <a href="chapter01_linear_algebra.html">Ch 1</a>
        <a href="chapter02_calculus_optimization.html">Ch 2</a>
        <a href="chapter03_probability_information.html">Ch 3</a>
        <a href="chapter04_feedforward_networks.html">Ch 4</a>
        <a href="chapter05_convolutional_networks.html">Ch 5</a>
        <a href="chapter06_recurrent_networks.html">Ch 6</a>
        <a href="chapter07_attention_fundamentals.html">Ch 7</a>
        <a href="chapter08_self_attention.html">Ch 8</a>
        <a href="chapter09_attention_variants.html">Ch 9</a>
        <a href="chapter10_transformer_model.html">Ch 10</a>
        <a href="chapter11_training_transformers.html">Ch 11</a>
        <a href="chapter12_computational_analysis.html">Ch 12</a>
        <a href="chapter13_bert.html">Ch 13</a>
        <a href="chapter14_gpt.html">Ch 14</a>
        <a href="chapter15_t5_bart.html">Ch 15</a>
        <a href="chapter16_efficient_transformers.html">Ch 16</a>
        <a href="chapter17_vision_transformers.html">Ch 17</a>
        <a href="chapter18_multimodal_transformers.html">Ch 18</a>
        <a href="chapter19_long_context.html">Ch 19</a>
        <a href="chapter20_pretraining_strategies.html">Ch 20</a>
        <a href="chapter21_pytorch_implementation.html">Ch 21</a>
        <a href="chapter22_hardware_optimization.html">Ch 22</a>
        <a href="chapter23_best_practices.html">Ch 23</a>
        <a href="chapter24_domain_specific_models.html">Ch 24</a>
        <a href="chapter25_enterprise_nlp.html">Ch 25</a>
        <a href="chapter26_code_language.html">Ch 26</a>
        <a href="chapter27_video_visual.html">Ch 27</a>
        <a href="chapter28_knowledge_graphs.html">Ch 28</a>
        <a href="chapter29_recommendations.html">Ch 29</a>
        <a href="chapter30_healthcare.html">Ch 30</a>
        <a href="chapter31_finance.html">Ch 31</a>
        <a href="chapter32_legal.html">Ch 32</a>
        <a href="chapter33_observability.html">Ch 33</a>
        <a href="chapter34_dsl_agents.html">Ch 34</a>
    </nav>

    <main>
        <h1>Finance, Risk, and Time Series Modeling</h1>

<h2>Chapter Overview</h2>

<p>Financial services represent one of the most data-intensive and competitive industries in the world, where milliseconds matter and billions of dollars are at stake. Global financial markets trade over \$6 trillion daily in foreign exchange alone. Credit card fraud costs \$28 billion annually. Credit decisions affect millions of consumers and trillions in lending. Algorithmic trading accounts for 60-75\% of US equity trading volume. In this environment, even marginal improvements in prediction accuracy, fraud detection, or risk management translate to enormous competitive advantages and financial returns.</p>

<p>This chapter examines how transformers and deep learning are transforming financial services across three critical domains: market prediction and algorithmic trading, financial text analysis for investment decisions, and credit risk assessment. Each domain presents unique challenges and opportunities. Market prediction faces non-stationary time series where patterns change constantly and historical data provides limited guidance. Financial NLP must process earnings calls, SEC filings, and news in real-time to extract actionable insights before markets react. Credit modeling must balance predictive accuracy with fairness, explainability, and regulatory compliance.</p>

<p>The business stakes are extraordinary. A hedge fund with a 1\% edge in market prediction can generate hundreds of millions in annual returns. A fraud detection system that improves accuracy by 2\% saves tens of millions in prevented losses. A credit model that reduces default rates by 0.5\% while maintaining approval rates generates millions in reduced losses. These improvements compound over time, creating sustainable competitive advantages in an industry where competitors are constantly innovating.</p>

<p>However, financial AI faces unique challenges that make it fundamentally different from other domains. Markets are adversarial‚Äîas soon as a profitable pattern is discovered and exploited, it disappears as others exploit it too. Non-stationarity is severe‚Äîmarket regimes shift suddenly during crises, rendering historical models useless. Regulatory scrutiny is intense‚Äîmodels must be explainable, auditable, and fair. Data is limited‚Äîunlike computer vision with millions of images, financial history provides only decades of data with few independent samples. And critically, financial AI operates in a zero-sum environment‚Äîyour gain is someone else's loss, creating intense competitive pressure and secrecy.</p>

<p>This chapter provides the technical foundation and business context to build financial AI systems that navigate these challenges. We examine successful strategies, regulatory requirements, risk management frameworks, and the economic models that make financial AI viable despite its unique difficulties. The focus is on practical deployment: what works in production, what fails, and why.</p>

<h2>Learning Objectives</h2>

<ol>
<li>Understand financial time series, stationarity, and non-stationarity
<li>Build transformer-based models for price prediction and risk forecasting
<li>Extract information from financial text: earnings calls, news, SEC filings
<li>Design credit scoring systems aligned with fairness and regulatory requirements
<li>Implement risk management workflows: backtesting, stress testing, VaR estimation
<li>Address regulatory requirements: explainability, model validation, governance
<li>Understand evaluation metrics specific to finance (Sharpe ratio, maximum drawdown, win rate)
</ol>

<h2>Market Data and Time Series Forecasting</h2>

<p>Financial time series (stock prices, exchange rates, commodities) are notoriously difficult to predict. They are non-stationary (mean and variance change over time) and driven by news, sentiment, and complex market dynamics.</p>

<h3>Time Series Characteristics</h3>

<div class="definition"><strong>Definition:</strong> 
A time series is non-stationary if its statistical properties (mean, variance, autocorrelation) change over time. Financial returns are approximately stationary (mean ‚âà 0, variance varies); prices themselves are non-stationary.
</div>

<p>Deep learning faces several fundamental challenges when applied to financial time series. Non-stationarity is perhaps the most severe: models trained on 2020 data often fail completely in 2024 as market regimes evolve and statistical properties change. This is compounded by regime shifts, where market behavior changes suddenly and dramatically‚Äîthe 2008 financial crisis, COVID-19 crash, and 2022 inflation shock all represented regime shifts that broke many quantitative models overnight. Models must continuously adapt to these changing conditions or risk catastrophic failure.</p>

<p>The limited data problem is unique to finance. Unlike computer vision with millions of labeled images or NLP with billions of text documents, financial markets provide only decades of historical data with relatively few independent samples. A model trained on 10 years of daily data has only 2,500 trading days‚Äîfar fewer than the millions of examples typical in other domains. This scarcity makes overfitting a constant danger: with few samples and many parameters, models easily memorize noise rather than learning genuine patterns. Finally, look-ahead bias‚Äîaccidentally using future information during training‚Äîis surprisingly easy to introduce and can make worthless models appear profitable in backtesting.</p>

<h3>Transformer-Based Time Series Models</h3>

<p>Transformers, originally designed for sequences, adapt well to time series:</p>

<div class="definition"><strong>Definition:</strong> 
<ol>
<li><strong>Input:</strong> Past L trading days of OHLCV (open, high, low, close, volume) data
<li><strong>Embedding:</strong> Project each day's features to d-dimensional space
<li><strong>Position encoding:</strong> Time-based position encodings; relative time differences matter
<li><strong>Transformer encoder:</strong> Self-attention allows model to weight recent vs. older prices
<li><strong>Output:</strong> Predict next day's close price or return
</ol>
</div>

<p>Transformers offer several key advantages for financial time series modeling. Parallelization enables processing the entire price history simultaneously, unlike RNNs which must process sequences step-by-step. This dramatically reduces training time and enables efficient use of modern GPU hardware. The attention mechanism naturally captures long-range dependencies, allowing the model to identify patterns like mean reversion over months or seasonal effects over years‚Äîrelationships that RNNs struggle to learn due to vanishing gradients. Finally, attention weights provide interpretability by revealing which historical days most influenced each prediction, helping traders understand and trust model decisions.</p>

<h3>Addressing Non-Stationarity</h3>

<p>Several techniques help address non-stationarity in financial models. Differencing transforms the problem by modeling log-returns instead of raw prices‚Äîreturns are approximately stationary with mean near zero, while prices exhibit clear trends and non-stationarity. Normalization standardizes features to zero mean and unit variance before feeding them to the model, preventing scale differences from dominating learning. Regime detection explicitly models market state changes, using different models or parameters for bull markets, bear markets, and crisis periods. Online learning continuously retrains models on recent data, weighting recent observations more heavily to adapt to current conditions. Finally, ensemble methods combine predictions from models trained on different time periods, providing robustness when any single model fails due to regime changes.</p>

<h3>Evaluation and Backtesting</h3>

<p>Standard accuracy metrics (RMSE, MAE) are misleading for trading. A model could predict prices with low RMSE but lose money trading.</p>

<p>Trading-specific metrics evaluate what actually matters for profitability. The Sharpe ratio measures risk-adjusted returns by dividing average return by volatility‚Äîhigher values indicate better performance per unit of risk, with values above 1.0 considered good and above 2.0 exceptional. Maximum drawdown captures the largest peak-to-trough decline, critical for risk management since large drawdowns can trigger margin calls or investor redemptions regardless of long-term returns. Win rate measures the fraction of profitable trades, though a strategy can be profitable with low win rate if winning trades are much larger than losing trades. Profit factor divides gross profits by gross losses, with values above 1.5 indicating robust strategies. The Calmar ratio divides annualized return by maximum drawdown, rewarding strategies that generate returns without large drawdowns.</p>

<p>Rigorous backtesting requires several critical practices. Walk-forward validation prevents look-ahead bias by training on historical data and testing on subsequent periods, then rolling forward: train on year 1, test on year 2, retrain on years 1-2, test on year 3, and so on. This simulates realistic deployment where models only have access to past data. Transaction costs must include all real-world expenses: commissions, bid-ask spreads, and slippage (the difference between expected and actual execution prices). Market impact modeling accounts for how large orders move prices against the trader‚Äîa strategy that works with small positions may fail at scale. Regulatory requirements impose capital requirements, position limits, and reporting obligations that constrain real-world trading. Finally, out-of-sample testing on completely held-out recent data provides the ultimate validation before deployment, ensuring the model works on data it has never seen during development.</p>

<h2>Financial NLP</h2>

<p>Markets are driven by information. News, earnings reports, and regulatory filings move prices. NLP extracts this information.</p>

<h3>Financial Domain Text</h3>

<p>Financial text comes in several distinct forms, each with unique characteristics and information content. Earnings calls provide transcripts of quarterly conference calls where company executives discuss results and answer analyst questions‚Äîforward guidance and management tone often signal future performance before it appears in financial statements. SEC filings include 10-K annual reports, 10-Q quarterly reports, and 8-K event disclosures, containing detailed financial and operational information required by regulators. News from Reuters, Bloomberg, and CNBC is highly time-sensitive, with price reactions occurring within seconds of publication. Analyst reports from investment banks provide buy, hold, or sell recommendations with significant influence on institutional investors. Finally, Twitter and social media capture retail sentiment, rumors, and market commentary that increasingly affects stock prices, particularly for retail-popular stocks.</p>

<h3>Information Extraction</h3>

<p>Information extraction from financial text involves several key tasks. Named entity recognition identifies companies, executives, and financial instruments mentioned in text, enabling tracking of which entities are discussed and in what context. Event extraction detects significant occurrences like merger and acquisition announcements, earnings surprises, and executive changes‚Äîevents that typically trigger immediate market reactions. Sentiment analysis classifies text tone as positive, negative, or neutral, capturing market psychology and expectations. Relationship extraction identifies connections between entities, such as which company acquired whom or which companies compete in the same market, building knowledge graphs of corporate relationships.</p>

<p>Consider a news headline: ``Apple Announces Record Q4 Revenue; Beats Analyst Expectations.'' Information extraction would identify the company as Apple, classify the event as an earnings announcement, extract the metric as Q4 revenue, and determine the sentiment as positive based on the words ``record'' and ``beats expectations.'' The predicted market impact would be a likely stock price increase, as positive earnings surprises typically drive immediate buying. This structured information can then feed into trading algorithms that act on news before human traders can react.</p>

<h3>Sentiment Analysis for Trading</h3>

<p>Aggregate sentiment from multiple sources to predict price movements:</p>

<ol>
<li>Collect news, social media, analyst sentiment from past hour
<li>Compute aggregate sentiment score (weighted average)
<li>If sentiment strongly positive and persistent, go long; strongly negative, go short
<li>Backtest: Does this strategy beat a buy-and-hold baseline?
</ol>

<p>Practical results: Simple sentiment strategies achieve 50--55\% win rate (barely above random), but with low transaction costs and diversification, can be profitable.</p>

<h2>Credit Modeling and Risk Management</h2>

<p>Credit scoring determines who gets loans and at what interest rate. Deep learning has improved credit modeling, but fairness and explainability are critical.</p>

<h3>Credit Risk Assessment</h3>

<p>Deep learning enables credit models to incorporate richer information than traditional approaches. Time series analysis processes payment history over years rather than just summary statistics, capturing patterns like seasonal payment behavior or gradual deterioration. Text analysis examines loan applications and borrower explanations, where unusual language patterns or inconsistencies may indicate fraud or misrepresentation. Network analysis identifies relationships between borrowers, detecting fraud rings where multiple applications share suspicious connections. Behavioral analysis tracks how borrowers interact with the application system‚Äîhesitation, multiple retries, or unusual navigation patterns can signal uncertainty or deception.</p>

<h3>Deep Learning for Credit</h3>

<div class="definition"><strong>Definition:</strong> 
Given borrower features (income, credit history, collateral, payment patterns), predict probability of default within specified time horizon (12 months, 3 years).

<p>Model: \(P(\text{default} = 1 \mid \text{features})\) = logistic(neural network)</p>

<p>Loss: Cross-entropy on default labels (highly imbalanced: 2--5\% default rate)
</div>

<p>Deep learning credit models employ several architectural components. Feature embedding encodes categorical variables like employment status and zip code as learned dense vectors, capturing semantic similarities (e.g., neighboring zip codes have similar embeddings). Temporal modules use LSTMs or transformers to process payment history sequences, learning patterns like improving or deteriorating payment behavior over time. Attention mechanisms identify which factors most influenced each decision, providing interpretability required for regulatory compliance. Regularization through L1/L2 penalties and dropout prevents overfitting, critical when default examples are scarce (typically 2-5</p>

<h3>Fairness in Credit Decisions</h3>

<p>Regulatory requirements (Fair Credit Reporting Act, Equal Credit Opportunity Act) prohibit discrimination on protected attributes (race, gender, religion). Yet models trained on historical data inherit biases:</p>

<p>If minorities historically received higher interest rates, the model learns to predict higher risk for minorities.</p>

<p>Several approaches address fairness in credit decisions. Constraint-based fairness requires equal acceptance rates across demographic groups, enforced during training through constrained optimization. Adversarial debiasing adds a classifier that attempts to predict protected attributes from model predictions, then trains the main model to fool this classifier‚Äîif the adversary cannot predict race from the model's outputs, the model is not using race as a proxy. Continuous monitoring measures disparate impact in production, alerting when approval rates diverge across groups beyond acceptable thresholds. Threshold tuning adjusts decision boundaries separately for each demographic group to achieve equal approval rates, though this approach raises legal questions about differential treatment.</p>

<h3>Explainability for Credit Decisions</h3>

<p>When a loan is denied, applicants have the right to explanation. ``The AI said no'' is insufficient.</p>

<p>Several interpretability methods provide explanations for credit decisions. SHAP values decompose each prediction into contributions from individual features, showing exactly how much each factor (income, credit score, payment history) influenced the decision. Attention analysis reveals which factors the model weighted most heavily, providing insight into the decision process. Counterfactual explanations answer ``what if'' questions: ``If your income were \$10,000 higher, you would be approved''‚Äîgiving applicants actionable guidance. Prototype examples show similar applicants who were approved, helping applicants understand what successful profiles look like and how their application compares.</p>

<h2>Risk Management and Regulatory Requirements</h2>

<p>Financial institutions are heavily regulated. Models used for trading or lending must be validated and auditable.</p>

<h3>Model Risk Management Framework</h3>

<p>Financial regulations require comprehensive model risk management. Model documentation must provide detailed specifications of the model architecture, training data, assumptions, and known limitations‚Äîsufficient for independent reviewers to understand and reproduce the model. Governance requires model review and approval by a risk committee before deployment, with ongoing oversight and periodic re-approval. Validation involves independent testing on data not used in development, performed by teams separate from model developers to ensure objectivity. Monitoring tracks ongoing performance in production, alerting when metrics degrade beyond acceptable thresholds. Backtesting compares historical predictions against actual outcomes to verify model accuracy and calibration. Stress testing evaluates performance under extreme market conditions like the 2008 financial crisis or COVID-19 crash, ensuring models remain safe during tail events.</p>

<h3>Value at Risk (VaR) Estimation</h3>

<p>VaR is the maximum loss expected at a given confidence level (e.g., 95\% VaR for a portfolio).</p>

<p>Deep learning provides a more sophisticated approach to VaR estimation. Rather than assuming returns follow a normal distribution (an assumption frequently violated in financial markets), neural networks or flow-based models learn the actual return distribution from data, capturing fat tails, skewness, and other non-normal characteristics. The model can then sample from this learned distribution or use quantile regression to directly estimate VaR at the desired confidence level (e.g., 95th or 99th percentile). This approach produces more accurate VaR estimates that better capture tail risk‚Äîthe extreme losses that matter most for risk management but are poorly modeled by traditional parametric methods.</p>

<h2>Case Study: Fraud Detection System</h2>

<p>A payment processor wants to detect fraudulent transactions in real-time.</p>

<h3>Problem Setup</h3>

<p>The fraud detection problem presents several challenges. The dataset contains 10 billion transactions annually with only 0.1</p>

<h3>Model Architecture</h3>

<p>The fraud detection architecture combines multiple components. Features include card ID, merchant information, transaction amount, location, time, and velocity metrics like transactions per card per hour. Embeddings encode high-cardinality categorical variables like card ID, merchant category, country, and device fingerprint as dense vectors. Temporal modeling uses RNNs or transformers to process the sequence of past 10 transactions for each card, learning patterns like normal spending behavior versus suspicious sequences. The output is a fraud probability score; transactions exceeding a threshold trigger additional verification like two-factor authentication or manual review.</p>

<h3>Results</h3>

<p>Offline evaluation measured performance on historical data. The key metric was recall at 1</p>

<p>Online deployment results demonstrated real-world effectiveness. The system achieved 88</p>

<h2>Model Drift in Financial Systems</h2>

<p>Financial AI systems face unique drift challenges that distinguish them from other domains. The general framework for understanding and managing model drift is presented in Chapter~24; here we focus on finance-specific patterns.</p>

<h3>Finance-Specific Drift Patterns</h3>

<p><strong>Market regime shifts</strong> cause sudden, fundamental changes in the relationships that models have learned. A model trained during a bull market may fail catastrophically during a bear market or financial crisis because the statistical relationships between features change qualitatively, not just quantitatively. The 2008 financial crisis, COVID-19 crash, and 2022 inflation shock all broke quantitative models that had not been exposed to comparable regimes. For example, a volatility model trained on 2015--2019 data predicted VIX below 20; in March 2020, VIX spiked to 80.</p>

<p><strong>Alpha decay</strong> is unique to trading models: as more market participants discover and exploit a predictive signal, the signal weakens through market efficiency. A trading strategy that generates 5\% annual returns may see returns decay to 1--2\% within 12--18 months as competitors adopt similar approaches. The industry average alpha half-life is estimated at 2--3 years, with high-frequency strategies decaying within months.</p>

<p><strong>Adversarial fraud evolution</strong> occurs because fraudsters actively adapt to detection models. Unlike natural drift where the data distribution shifts gradually, fraud patterns change deliberately and rapidly in response to detection. New fraud schemes---geographic shifts, velocity changes, amount manipulation, synthetic identities---can emerge within weeks of a model deployment, requiring continuous model updates.</p>

<p><strong>Regulatory drift</strong> arises from changing compliance requirements (e.g., Basel III to Basel IV, new stress testing mandates, interest rate regime changes) that alter the features, constraints, or objectives of financial models. When the Federal Reserve raised rates from 0\% to 5\% in 2022--2023, models trained in the zero-rate environment required complete recalibration.</p>

<p><strong>Economic cycle drift</strong> affects credit models as borrower behavior differs between expansion and recession. A mortgage model trained on 2010--2019 expansion data predicted 2\% defaults; during the 2020 recession, actual defaults reached 5\%, causing hundreds of millions in unexpected losses.</p>

<h3>Monitoring and Adaptation</h3>

<p>Financial drift detection requires domain-specific metrics: Sharpe ratio and drawdown for trading, precision/recall for fraud, calibration accuracy for credit. Use walk-forward validation continuously and implement regime detection (hidden Markov models or clustering on volatility patterns) to trigger model switching. For fraud detection, conduct regular adversarial red-teaming. Retrain aggressively: trading models weekly, fraud models daily, credit models quarterly. See Chapter~24 for the general continuous learning framework.</p>

<div class="keypoint">
Financial drift patterns are distinguished by their adversarial nature (fraud), reflexivity (alpha decay), and regime-dependent behavior (market shifts). Standard drift detection approaches from Chapter~24 must be augmented with regime-aware monitoring and adversarial robustness testing specific to financial applications.
</div>

<h2>Exercises</h2>

<div class="exercise" id="exercise-1"><strong>Exercise 1:</strong> Build a time series model for stock price prediction. Train on 5 years of historical S\&P 500 data. Evaluate using Sharpe ratio and maximum drawdown in addition to RMSE. Can you beat a buy-and-hold baseline?
</div>

<div class="exercise" id="exercise-2"><strong>Exercise 2:</strong> Extract events from earnings call transcripts. Identify mentions of: new products, executive changes, competitive threats, guidance changes. Build a classifier to predict stock price movement after earnings announcement.
</div>

<div class="exercise" id="exercise-3"><strong>Exercise 3:</strong> Design a fair credit scoring model. Start with a baseline model that uses standard features. Measure disparate impact (difference in approval rates across demographic groups). Apply debiasing techniques. Can you reduce disparate impact while maintaining predictive power?
</div>

<h2>Solutions</h2>

<p>Full solutions for all exercises are available at \url{https://deeplearning.hofkensvermeulen.be}.</p>

<div class="solution"><strong>Solution:</strong> <strong>Exercise 1: Stock Price Prediction</strong>

<p>\itshape Data:
<ul>
<li>S\&P 500 daily OHLCV data, 2018--2023
<li>1260 trading days per year; 6300 days total
<li>Train on 2018--2021 (4 years), test on 2022--2023 (2 years)
</ul>

<p>\itshape Model:
<ul>
<li>Input: 60-day rolling window of returns
<li>Transformer: 2 layers, 4 heads
<li>Output: Predict next-day return
<li>Loss: MSE on returns (not prices)
</ul>

<p>\itshape Evaluation:
<ul>
<li>RMSE: 0.015 (1.5\% prediction error)
<li>But is this useful for trading?
<li>Sharpe ratio of predictions: 0.3 (very low; barely profitable after costs)
<li>Maximum drawdown: -18\% (high risk)
<li>Comparison: Buy-and-hold S\&P 500 2022-2023 achieved Sharpe ratio 0.2, max drawdown -20\%
<li>Conclusion: Model slightly outperforms but not statistically significant; overfitting likely
</ul>

<p>\itshape Improvements:
<ul>
<li>More features: Volume, sector rotation, VIX (volatility index)
<li>Regime detection: Different models for bull vs. bear markets
<li>Ensemble: Combine with technical indicators, sentiment models
<li>Transaction costs: Even profitable strategies lose money after commissions/spreads
</ul>

<p>Bottom line: Stock prediction is hard; even slight edge requires careful implementation and is fragile to market changes.
</div>

<div class="solution"><strong>Solution:</strong> <strong>Exercise 2: Event Extraction from Earnings Calls</strong>

<p>\itshape Data collection:
<ul>
<li>Source: Seeking Alpha, company investor relations websites
<li>Dataset: 200 earnings call transcripts with stock price movements next day
<li>Annotation: For each call, label event type and price movement direction
</ul>

<p>\itshape Model:
<ul>
<li>Pre-processing: Split transcript into speaker turns (management vs. analyst)
<li>NER + relation extraction: Identify company names, executives, products
<li>Event detection: Multi-class classification for each sentence: new product, executive change, etc.
<li>Sentiment: Overall call sentiment (positive/negative/neutral)
</ul>

<p>\itshape Evaluation:
<ul>
<li>Event extraction F1: 0.75 (reasonable; humans also disagree on event interpretation)
<li>Sentiment classification: 0.82 accuracy
<li>Price movement prediction: Train a model on extracted events + sentiment ‚Üí next day return
<li>Results: 55\% accuracy (barely above 50\% random for binary up/down)
<li>Reason: Stock movements driven by many factors; earnings data alone insufficient
</ul>

<p>\itshape Practical use:
Despite low accuracy, events provide valuable context for traders. Supplemented with other signals, earnings event extraction improves trading decisions.
</div>

<div class="solution"><strong>Solution:</strong> <strong>Exercise 3: Fair Credit Scoring</strong>

<p>\itshape Baseline model:
<ul>
<li>Data: 50K applicants, 5\% default rate
<li>Features: Income, credit score, debt-to-income ratio, employment status, zip code
<li>Model: Logistic regression
<li>Approval rate: 80\% overall; 85\% white applicants, 70\% black applicants (disparate impact)
</ul>

<p>\itshape Fairness metrics:
<ul>
<li>Disparate impact ratio: 70\% / 85\% = 0.82 (rule of 4/5 threshold is 0.80)
<li>Just barely legal, but problematic
</ul>

<p>\itshape Debiasing approach 1: Adversarial debiasing
<ul>
<li>Main model: Predict default
<li>Adversary: Predict race from model's prediction
<li>Train: Minimize default loss + maximize adversary's confusion about race
<li>Result: Disparate impact improved to 0.92; default prediction accuracy maintained at 0.72 AUC
</ul>

<p>\itshape Debiasing approach 2: Threshold tuning
<ul>
<li>Use different acceptance thresholds for different demographics
<li>Adjust to ensure equal approval rates: 80\% for all groups
<li>Trade-off: Default rates become slightly different (78\% default prediction accuracy for white, 75\% for black)
<li>Acceptable if default prediction accuracy reasonably maintained
</ul>

<p>\itshape Conclusion:
Fairness improvements are possible but often involve accuracy trade-offs or legal complexity. Regulatory guidance evolving; best practice is to measure disparate impact and document decisions transparently.
</div>
        
        <div class="chapter-nav">
  <a href="chapter30_healthcare.html">‚Üê Chapter 30: Healthcare Applications</a>
  <a href="../../deeptech.html">üìö Table of Contents</a>
  <a href="chapter32_legal.html">Chapter 32: Legal and Compliance Applications ‚Üí</a>
</div>

    </main>

    <footer>
        <p>&copy; 2026 Deep Learning and Transformers Textbook. All rights reserved.</p>
    </footer>

    <script src="../js/main.js"></script>
</body>
</html>
